name: staging action

permissions:
  contents: write

on:
  push:
    branches:
      - staging

jobs:
  build:
    name: Build and Deploy
    runs-on: ubuntu-22.04

    steps:
        - name: Checkout
          uses: actions/checkout@v2

        - name: Set up Node.js
          uses: actions/setup-node@v2
          with:
            node-version: '20.9.0'

        - name: install yarn
          run: npm install -g corepack && corepack enable && yarn set version 4.0.1

        - name: install dependencies
          run: yarn install --immutable

        - name: create env
          run: echo ${{ secrets.TEST_ENV }} > .env

        - name: build
          run: npm run build

        - name: deploy to github pages
          uses: JamesIves/github-pages-deploy-action@v4
          with:
            folder: build/